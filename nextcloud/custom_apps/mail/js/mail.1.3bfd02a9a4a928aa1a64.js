(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{620:function(t,e,n){var a=n(761);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,n(342).default)("f5677480",a,!0,{})},621:function(t,e,n){var a=n(763);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,n(342).default)("7cf5a1ef",a,!0,{})},665:function(e,a,o){"use strict";var i=o(828),r=o.n(i),c=o(829),s=o.n(c),l=o(830),u=o.n(l),d=o(831),p=o.n(d),f=o(629),h=o.n(f),v=o(839),g=o.n(v),m=o(841),_=o.n(m),b=o(610),A=o.n(b),k=o(667),x=o.n(k),w=o(1),O=o(668),S=o(18),y={name:"NavigationAccount",components:{AppNavigationItem:h.a,AppNavigationIconBullet:g.a,ActionRouter:_.a,ActionButton:A.a,ActionInput:x.a},props:{account:{type:Object,required:!0},isFirst:{type:Boolean,default:!1},isLast:{type:Boolean,default:!1}},data:function(){return{menuOpen:!1}},computed:{visible:function(){return!0!==this.account.isUnified&&!1!==this.account.visible},settingsRoute:function(){return{name:"accountSettings",params:{accountId:this.account.id}}},id:function(){return"account-"+this.account.id},bulletColor:function(){return this.account.error?void 0:Object(O.a)(this.account.emailAddress)},iconError:function(){return this.account.error?"icon-error":void 0}},methods:{createFolder:function(t){var e=t.target.elements[1].value;S.a.info("creating folder "+e),this.menuOpen=!1,this.$store.dispatch("createFolder",{account:this.account,name:e}).then((function(){return S.a.info("folder ".concat(e," created"))})).catch((function(t){throw S.a.error("could not create folder",{error:t}),t}))},deleteAccount:function(){var t=this.account.id;this.$store.dispatch("deleteAccount",this.account).then((function(){S.a.info("account ".concat(t," deleted, redirecting …")),location.href=Object(w.generateUrl)("/apps/mail")})).catch((function(t){return S.a.error("could not delete account",{error:t})}))},changeAccountOrderUp:function(){this.$store.dispatch("moveAccount",{account:this.account,up:!0}).catch((function(t){return S.a.error("could not move account up",{error:t})}))},changeAccountOrderDown:function(){this.$store.dispatch("moveAccount",{account:this.account}).catch((function(t){return S.a.error("could not move account down",{error:t})}))}}},N=o(35),I=Object(N.a)(y,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.visible?n("AppNavigationItem",{key:t.id,attrs:{id:t.id,icon:t.iconError,"menu-open":t.menuOpen,title:t.account.emailAddress,to:t.settingsRoute},on:{"update:menuOpen":function(e){t.menuOpen=e},"update:menu-open":function(e){t.menuOpen=e}},scopedSlots:t._u([{key:"actions",fn:function(){return[n("ActionRouter",{attrs:{to:t.settingsRoute,icon:"icon-settings"}},[t._v("\n\t\t\t"+t._s(t.t("mail","Edit account"))+"\n\t\t")]),t._v(" "),n("ActionInput",{attrs:{icon:"icon-add"},on:{submit:t.createFolder}},[t._v("\n\t\t\t"+t._s(t.t("mail","Add folder"))+"\n\t\t")]),t._v(" "),t.isFirst?t._e():n("ActionButton",{attrs:{icon:"icon-triangle-n"},on:{click:t.changeAccountOrderUp}},[t._v("\n\t\t\t"+t._s(t.t("mail","Move Up"))+"\n\t\t")]),t._v(" "),t.isLast?t._e():n("ActionButton",{attrs:{icon:"icon-triangle-s"},on:{click:t.changeAccountOrderDown}},[t._v("\n\t\t\t"+t._s(t.t("mail","Move down"))+"\n\t\t")]),t._v(" "),t.account.provisioned?t._e():n("ActionButton",{attrs:{icon:"icon-delete"},on:{click:t.deleteAccount}},[t._v("\n\t\t\t"+t._s(t.t("mail","Delete account"))+"\n\t\t")])]},proxy:!0}],null,!1,1751902140)},[t.bulletColor?n("AppNavigationIconBullet",{attrs:{slot:"icon",color:t.bulletColor},slot:"icon"}):t._e()],1):t._e()}),[],!1,null,null,null).exports,j={name:"NavigationAccount",components:{AppNavigationItem:h.a},props:{account:{type:Object,required:!0}},computed:{id:function(){return"collapse-"+this.account.id},title:function(){return this.account.collapsed?t("mail","Show all folders"):t("mail","Collapse folders")}},methods:{toggleCollapse:function(){this.$store.commit("toggleAccountCollapsed",this.account.id)}}},U=(o(760),Object(N.a)(j,(function(){var t=this.$createElement;return(this._self._c||t)("AppNavigationItem",{attrs:{title:this.title},on:{click:this.toggleCollapse}})}),[],!1,null,"7015b306",null).exports),C=o(845),$=o.n(C),F=o(846),R=o.n(F),E=o(184),M=o(23),L=function(t){if(t.specialUse.length>0)try{return function(t){if(t.specialUse.includes("all"))return Object(M.translate)("mail","All");if(t.specialUse.includes("archive"))return Object(M.translate)("mail","Archive");if(t.specialUse.includes("drafts"))return Object(M.translate)("mail","Drafts");if(t.specialUse.includes("flagged"))return Object(M.translate)("mail","Favorites");if(t.specialUse.includes("inbox"))return!0===t.isUnified?Object(M.translate)("mail","All inboxes"):Object(M.translate)("mail","Inbox");if(t.specialUse.includes("junk"))return Object(M.translate)("mail","Junk");if(t.specialUse.includes("sent"))return Object(M.translate)("mail","Sent");if(t.specialUse.includes("trash"))return Object(M.translate)("mail","Trash");throw new Error("unknown special use ".concat(t.specialUse))}(t)}catch(t){console.error("could not translate special folder",t)}return t.displayName};function P(t,e,n,a,o,i,r){try{var c=t[i](r),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(a,o)}var B,T,D={name:"NavigationFolder",components:{AppNavigationItem:h.a,AppNavigationCounter:$.a,ActionText:R.a,ActionButton:A.a,ActionInput:x.a},props:{account:{type:Object,required:!0},folder:{type:Object,required:!0},top:{type:Boolean,default:!0}},data:function(){return{folderStats:void 0,loadingMarkAsRead:!1}},computed:{title:function(){return L(this.folder)},folderId:function(){return atob(this.folder.id)},icon:function(){return this.folder.specialRole?"icon-"+this.folder.specialRole:"icon-folder"},to:function(){return{name:"folder",params:{accountId:this.account.id,folderId:this.folder.id}}},subFolders:function(){return this.$store.getters.getSubfolders(this.account.id,this.folder.id)},statsText:function(){return this.folderStats&&"total"in this.folderStats&&"unread"in this.folderStats?0===this.folderStats.unread?n("mail","{total} message","{total} messages",{total:this.folderStats.total}):n("mail","{unread} unread of {total}","{unread} unread of {total}",{total:this.folderStats.total,unread:this.folderStats.unread}):t("mail","Loading …")}},methods:{genId:function(t){return"account-"+this.account.id+"_"+t.id},onMenuToggle:function(t){t&&this.fetchFolderStats()},fetchFolderStats:(B=regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.folderStats=null,t.prev=1,t.next=4,Object(E.c)(this.account.id,this.folder.id);case 4:e=t.sent,S.a.debug("loaded folder stats",{stats:e}),this.folderStats=e,t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),this.folderStats={error:!0},S.a.error("could not load folder stats for ".concat(this.folder.id),t.t0);case 13:case"end":return t.stop()}}),t,this,[[1,9]])})),T=function(){var t=this,e=arguments;return new Promise((function(n,a){var o=B.apply(t,e);function i(t){P(o,n,a,i,r,"next",t)}function r(t){P(o,n,a,i,r,"throw",t)}i(void 0)}))},function(){return T.apply(this,arguments)}),createFolder:function(t){var e=t.target.elements[1].value,n=atob(this.folder.id)+this.folder.delimiter+e;S.a.info("creating folder ".concat(n," as subfolder of ").concat(this.folder.id)),this.menuOpen=!1,this.$store.dispatch("createFolder",{account:this.account,name:n}).then((function(){return S.a.info("folder ".concat(n," created"))})).catch((function(t){throw S.a.error("could not create folder ".concat(n),{error:t}),t}))},markAsRead:function(){var t=this;this.loadingMarkAsRead=!0,this.$store.dispatch("markFolderRead",{account:this.account,folderId:this.folder.id}).then((function(){return S.a.info("folder ".concat(t.folder.id," marked as read"))})).catch((function(e){return S.a.error("could not mark folder ".concat(t.folder.id," as read"),{error:e})})).then((function(){return t.loadingMarkAsRead=!1}))}}},H=Object(N.a)(D,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("AppNavigationItem",{key:t.genId(t.folder),attrs:{id:t.genId(t.folder),"allow-collapse":!0,icon:t.icon,title:t.title,to:t.to},on:{"update:menuOpen":t.onMenuToggle}},[n("template",{slot:"actions"},[t.top?[t.account.isUnified?t._e():n("ActionText",{attrs:{icon:"icon-info",title:t.folderId}},[t._v("\n\t\t\t\t"+t._s(t.statsText)+"\n\t\t\t")]),t._v(" "),t.account.isUnified?t._e():n("ActionButton",{attrs:{icon:"icon-checkmark",title:t.t("mail","Mark all as read"),disabled:t.loadingMarkAsRead},on:{click:t.markAsRead}},[t._v("\n\t\t\t\t"+t._s(t.t("mail","Mark all messages of this folder as read"))+"\n\t\t\t")]),t._v(" "),t.account.isUnified?t._e():n("ActionInput",{attrs:{icon:"icon-add"},on:{submit:t.createFolder}},[t._v("\n\t\t\t\t"+t._s(t.t("mail","Add subfolder"))+"\n\t\t\t")])]:t._e()],2),t._v(" "),t.folder.unread?n("AppNavigationCounter",{attrs:{slot:"counter"},slot:"counter"},[t._v("\n\t\t"+t._s(t.folder.unread)+"\n\t")]):t._e(),t._v(" "),t._l(t.subFolders,(function(e){return n("NavigationFolder",{key:t.genId(e),attrs:{account:t.account,folder:e,top:!1}})}))],2)}),[],!1,null,null,null).exports,q={name:"AppSettingsMenu",data:function(){return{loadingAvatarSettings:!1}},computed:{useExternalAvatars:function(){return"true"===this.$store.getters.getPreference("external-avatars","true")}},methods:{onToggleExternalAvatars:function(t){var e=this;this.loadingAvatarSettings=!0,this.$store.dispatch("savePreference",{key:"external-avatars",value:t.target.checked?"true":"false"}).catch((function(t){return S.a.error("could not save preferences",{error:t})})).then((function(){e.loadingAvatarSettings=!1}))},registerProtocolHandler:function(){if(window.navigator.registerProtocolHandler){var t=window.location.protocol+"//"+window.location.host+Object(w.generateUrl)("apps/mail/compose?uri=%s");try{window.navigator.registerProtocolHandler("mailto",t,OC.theme.name+" Mail")}catch(t){S.a.error("could not register protocol handler",{err:t})}}}}},J=(o(762),Object(N.a)(q,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("router-link",{staticClass:"icon-add-white app-settings-button button primary new-button",attrs:{to:"/setup"}},[t._v("\n\t\t"+t._s(t.t("mail","Add mail account"))+"\n\t")]),t._v(" "),t.loadingAvatarSettings?n("p",{staticClass:"app-settings avatar-settings"},[n("span",{staticClass:"icon-loading-small"}),t._v("\n\t\t"+t._s(t.t("mail","Use Gravatar and favicon avatars"))+"\n\t")]):n("p",{staticClass:"app-settings"},[n("input",{staticClass:"checkbox",attrs:{id:"gravatar-enabled",type:"checkbox"},domProps:{checked:t.useExternalAvatars},on:{change:t.onToggleExternalAvatars}}),t._v(" "),n("label",{attrs:{for:"gravatar-enabled"}},[t._v(t._s(t.t("mail","Use Gravatar and favicon avatars")))])]),t._v(" "),n("p",[n("button",{staticClass:"icon-mail app-settings-button",on:{click:t.registerProtocolHandler}},[t._v("\n\t\t\t"+t._s(t.t("mail","Register as application for mail links"))+"\n\t\t")])]),t._v(" "),n("p",{staticClass:"icon-details app-settings-button button"},[n("router-link",{attrs:{to:{name:"keyboardShortcuts"}}},[t._v("\n\t\t\t"+t._s(t.t("mail","Keyboard shortcuts"))+"\n\t\t")])],1),t._v(" "),n("p",{staticClass:"app-settings-hint app-settings-link"},[n("a",{attrs:{href:"https://www.mailvelope.com/",target:"_blank"}},[t._v(t._s(t.t("mail","Looking for a way to encrypt your emails? Install the Mailvelope browser extension!")))])])],1)}),[],!1,null,"14b23999",null).exports),W=Object.seal(["inbox","flagged","drafts","sent"]),G={name:"Navigation",components:{AppNavigation:r.a,AppNavigationNew:s.a,AppNavigationSettings:u.a,AppNavigationSpacer:p.a,AppSettingsMenu:J,NavigationAccount:I,NavigationAccountExpandCollapse:U,NavigationFolder:H},data:function(){return{SHOW_COLLAPSED:W}},computed:{menu:function(){var t=this;return this.$store.getters.accounts.map((function(e){var n=t.$store.getters.getFolders(e.id).filter((function(t){return!e.collapsed||-1!==W.indexOf(t.specialRole)}));return{id:e.id,account:e,folders:n}}))}},methods:{onNewMessage:function(){this.$router.push({name:"message",params:{accountId:this.$route.params.accountId,folderId:this.$route.params.folderId,messageUid:"new"}})},isFirst:function(t){return t===this.$store.getters.accounts[1]},isLast:function(t){var e=this.$store.getters.accounts;return t===e[e.length-1]}}},K=Object(N.a)(G,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("AppNavigation",[n("AppNavigationNew",{attrs:{text:t.t("mail","New message"),"button-id":"mail_new_message","button-class":"icon-add"},on:{click:t.onNewMessage}}),t._v(" "),n("ul",{attrs:{id:"accounts-list"}},[t._l(t.menu,(function(e){return[e.account?n("NavigationAccount",{key:e.account.id,attrs:{account:e.account,"is-first":t.isFirst(e.account),"is-last":t.isLast(e.account)}}):t._e(),t._v(" "),t._l(e.folders,(function(a){return n("NavigationFolder",{directives:[{name:"show",rawName:"v-show",value:!e.account.collapsed||-1!==t.SHOW_COLLAPSED.indexOf(a.specialRole),expression:"!group.account.collapsed || SHOW_COLLAPSED.indexOf(item.specialRole) !== -1"}],key:a.key,attrs:{account:e.account,folder:a}})})),t._v(" "),!e.account.isUnified&&e.account.folders.length>0?n("NavigationAccountExpandCollapse",{key:"collapse-"+e.account.id,attrs:{account:e.account}}):t._e(),t._v(" "),n("AppNavigationSpacer",{key:"spacer-"+e.account.id})]}))],2),t._v(" "),n("AppNavigationSettings",{attrs:{title:t.t("mail","Settings")}},[n("AppSettingsMenu")],1)],1)}),[],!1,null,"1c849ed8",null);a.a=K.exports},668:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var a=n(619),o=n.n(a),i=n(843),r=n.n(i),c=function(t){var e=o()(t),n=r.a.hex.hsl(e),a=[40*Math.round(n[0]/40),n[1],n[2]];return"#"+r.a.hsl.hex(a)}},760:function(t,e,n){"use strict";var a=n(620);n.n(a).a},761:function(t,e,n){(e=n(341)(!1)).push([t.i,"[data-v-7015b306] .app-navigation-entry__title{color:var(--color-text-maxcontrast)}\n",""]),t.exports=e},762:function(t,e,n){"use strict";var a=n(621);n.n(a).a},763:function(t,e,n){(e=n(341)(!1)).push([t.i,"\np.avatar-settings span.icon-loading-small[data-v-14b23999] {\n\tdisplay: inline-block;\n\tvertical-align: middle;\n\tpadding: 5px 0;\n}\np.app-settings[data-v-14b23999] {\n\tpadding: 10px 0;\n}\n.app-settings-button[data-v-14b23999] {\n\tdisplay: block;\n\tpadding-left: 34px;\n\tbackground-position: 10px center;\n}\n.app-settings-link[data-v-14b23999] {\n\ttext-decoration: underline;\n}\n",""]),t.exports=e}}]);
//# sourceMappingURL=mail.1.3bfd02a9a4a928aa1a64.js.map